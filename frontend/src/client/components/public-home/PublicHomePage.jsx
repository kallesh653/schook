import React,{useState,useEffect}from'react';import{Container,Typography,Grid,Card,CardContent,Box,Paper,Button,Chip,Avatar,IconButton,Fade,CircularProgress}from'@mui/material';import{School as SchoolIcon,Phone as PhoneIcon,Email as EmailIcon,LocationOn as LocationIcon,Facebook,Twitter,Instagram,YouTube,LinkedIn,ArrowForward,EmojiEvents,People,MenuBook,ChevronLeft,ChevronRight,Star}from'@mui/icons-material';import{styled,keyframes}from'@mui/material/styles';import axios from'axios';import{baseUrl}from'../../../environment';import{useNavigate}from'react-router-dom';const fadeInUp=keyframes`from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}`;const pulse=keyframes`0%,100%{transform:scale(1)}50%{transform:scale(1.05)}`;const HeroSection=styled(Box)({position:'relative',minHeight:'600px',display:'flex',alignItems:'center',justifyContent:'center',color:'white',overflow:'hidden',background:'linear-gradient(135deg,#667eea 0%,#764ba2 100%)'});const HeroImage=styled('img')({position:'absolute',top:0,left:0,width:'100%',height:'100%',objectFit:'cover',zIndex:0});const HeroOverlay=styled(Box)({position:'absolute',top:0,left:0,right:0,bottom:0,background:'linear-gradient(135deg,rgba(102,126,234,0.9)0%,rgba(118,75,162,0.9)100%)',zIndex:1});const HeroContent=styled(Container)({position:'relative',zIndex:2,textAlign:'center',padding:'2rem'});const StatCard=styled(Paper)(({theme})=>({padding:theme.spacing(4),textAlign:'center',background:'linear-gradient(135deg,#667eea 0%,#764ba2 100%)',color:'white',borderRadius:'16px',transition:'all 0.3s ease','&:hover':{transform:'translateY(-10px)',boxShadow:'0 20px 40px rgba(102,126,234,0.4)'}}));const ProgramCard=styled(Card)({height:'100%',borderRadius:'16px',transition:'all 0.3s ease','&:hover':{transform:'translateY(-10px)',boxShadow:'0 20px 40px rgba(0,0,0,0.1)'}});const PublicHomePage=()=>{const navigate=useNavigate();const[loading,setLoading]=useState(!0);const[homeData,setHomeData]=useState(null);const[error,setError]=useState(null);const[currentSlide,setCurrentSlide]=useState(0);useEffect(()=>{fetchHomePageContent()},[]);useEffect(()=>{if(homeData?.sliders?.length>1){const timer=setInterval(()=>{setCurrentSlide(e=>(e+1)%homeData.sliders.length)},5e3);return()=>clearInterval(timer)}},[homeData]);const fetchHomePageContent=async()=>{try{setLoading(!0);const e=await axios.get(`${baseUrl}/home-page-content/public`);e.data.success&&setHomeData(e.data.data)}catch(e){console.error('Error:',e),setError('Unable to load')}finally{setLoading(!1)}};const getSocialIcon=e=>({facebook:<Facebook/>,twitter:<Twitter/>,instagram:<Instagram/>,youtube:<YouTube/>,linkedin:<LinkedIn/>}[e]);const getImageUrl=e=>{if(!e)return'';if(e.startsWith('http'))return e;return baseUrl.replace('/api','')+e};if(loading)return<Box display="flex"flexDirection="column"justifyContent="center"alignItems="center"minHeight="100vh"sx={{background:'linear-gradient(135deg,#667eea 0%,#764ba2 100%)'}}><CircularProgress sx={{color:'white',mb:2}}size={60}/><Typography variant="h6"sx={{color:'white'}}>Loading...</Typography></Box>;if(error||!homeData)return<Container maxWidth="md"sx={{py:8,textAlign:'center'}}><SchoolIcon sx={{fontSize:80,color:'#667eea',mb:2}}/><Typography variant="h4"gutterBottom>Welcome</Typography><Typography variant="body1"color="text.secondary"sx={{mb:4}}>Website setup in progress!</Typography><Button variant="contained"size="large"onClick={()=>navigate('/login')}sx={{background:'linear-gradient(135deg,#667eea 0%,#764ba2 100%)'}}>Login</Button></Container>;const{header,sliders=[],statistics=[],about,programs=[],whyChooseUs,testimonials,gallery=[],sectionVisibility}=homeData;const testimonialsArray=testimonials?.items||[];return<Box sx={{bgcolor:'#f8f9fa'}}>{header&&<Box sx={{bgcolor:header.primaryColor||'#667eea',color:'white',py:1.5}}><Container maxWidth="xl"><Box display="flex"justifyContent="space-between"alignItems="center"flexWrap="wrap"gap={2}><Box display="flex"gap={3}alignItems="center"flexWrap="wrap">{header.contactPhone&&<Box display="flex"alignItems="center"gap={.5}><PhoneIcon fontSize="small"/><Typography variant="body2">{header.contactPhone}</Typography></Box>}{header.contactEmail&&<Box display="flex"alignItems="center"gap={.5}><EmailIcon fontSize="small"/><Typography variant="body2">{header.contactEmail}</Typography></Box>}{header.address&&<Box display="flex"alignItems="center"gap={.5}><LocationIcon fontSize="small"/><Typography variant="body2">{header.address}</Typography></Box>}</Box><Box display="flex"gap={1}>{header.socialMedia&&Object.entries(header.socialMedia).map(([e,a])=>a&&<IconButton key={e}size="small"sx={{color:'white'}}href={a}target="_blank">{getSocialIcon(e)}</IconButton>)}</Box></Box></Container></Box>}{header&&<Box sx={{bgcolor:'white',boxShadow:'0 2px 10px rgba(0,0,0,0.1)',position:'sticky',top:0,zIndex:100}}><Container maxWidth="xl"><Box display="flex"justifyContent="space-between"alignItems="center"py={2}><Box display="flex"alignItems="center"gap={2}>{header.logo&&<Avatar src={getImageUrl(header.logo)}alt={header.schoolName}sx={{width:60,height:60,border:`3px solid ${header.primaryColor||'#667eea'}`}}/>}<Box><Typography variant="h5"fontWeight="bold"sx={{color:header.primaryColor||'#667eea'}}>{header.schoolName||'School'}</Typography><Typography variant="body2"color="text.secondary">{header.tagline||'Excellence'}</Typography></Box></Box><Box display="flex"gap={2}><Button variant="outlined"onClick={()=>navigate('/login')}sx={{borderColor:header.primaryColor,color:header.primaryColor}}>Login</Button><Button variant="contained"onClick={()=>navigate('/contact')}sx={{background:`linear-gradient(135deg,${header.primaryColor||'#667eea'}0%,${header.secondaryColor||'#764ba2'}100%)`}}>Contact</Button></Box></Box></Container></Box>}{sectionVisibility?.showSlider&&sliders?.length>0?<HeroSection>{sliders.map((e,a)=><Fade key={a}in={currentSlide===a}timeout={1e3}><Box sx={{position:'absolute',width:'100%',height:'100%',display:currentSlide===a?'block':'none'}}>{e.image&&<HeroImage src={getImageUrl(e.image)}alt={e.title}/>}<HeroOverlay/></Box></Fade>)}<HeroContent maxWidth="md"><Fade in timeout={1e3}><Box><Typography variant="h2"fontWeight="bold"gutterBottom sx={{fontSize:{xs:'2rem',md:'3.5rem'}}}>{sliders[currentSlide]?.title||header?.schoolName}</Typography><Typography variant="h5"sx={{mb:4,fontSize:{xs:'1rem',md:'1.5rem'}}}>{sliders[currentSlide]?.description||header?.tagline}</Typography>{sliders[currentSlide]?.buttonText&&<Button variant="contained"size="large"endIcon={<ArrowForward/>}href={sliders[currentSlide].buttonLink||'#'}sx={{bgcolor:'white',color:header?.primaryColor,px:4,py:1.5}}>{sliders[currentSlide].buttonText}</Button>}</Box></Fade></HeroContent>{sliders.length>1&&<><IconButton onClick={()=>setCurrentSlide(e=>(e-1+sliders.length)%sliders.length)}sx={{position:'absolute',left:20,top:'50%',transform:'translateY(-50%)',bgcolor:'rgba(255,255,255,0.3)',color:'white',zIndex:3}}><ChevronLeft fontSize="large"/></IconButton><IconButton onClick={()=>setCurrentSlide(e=>(e+1)%sliders.length)}sx={{position:'absolute',right:20,top:'50%',transform:'translateY(-50%)',bgcolor:'rgba(255,255,255,0.3)',color:'white',zIndex:3}}><ChevronRight fontSize="large"/></IconButton><Box sx={{position:'absolute',bottom:30,left:'50%',transform:'translateX(-50%)',display:'flex',gap:1,zIndex:3}}>{sliders.map((e,a)=><Box key={a}onClick={()=>setCurrentSlide(a)}sx={{width:12,height:12,borderRadius:'50%',bgcolor:currentSlide===a?'white':'rgba(255,255,255,0.5)',cursor:'pointer'}}/>)}</Box></>}</HeroSection>:<HeroSection><HeroOverlay/><HeroContent maxWidth="md"><Typography variant="h2"fontWeight="bold"gutterBottom sx={{fontSize:{xs:'2rem',md:'3.5rem'}}}>{header?.schoolName||'Welcome'}</Typography><Typography variant="h5"sx={{mb:4}}>{header?.tagline||'Excellence'}</Typography><Button variant="contained"size="large"endIcon={<ArrowForward/>}onClick={()=>navigate('/register')}sx={{bgcolor:'white',color:header?.primaryColor,px:4,py:1.5}}>Enroll</Button></HeroContent></HeroSection>}{sectionVisibility?.showStatistics&&statistics?.length>0&&<Container maxWidth="xl"sx={{py:8,mt:-4,position:'relative',zIndex:10}}><Grid container spacing={3}>{statistics.map((e,a)=><Grid item xs={12}sm={6}md={3}key={a}><StatCard elevation={6}><Typography variant="h2"fontWeight="bold"sx={{fontSize:'3rem'}}>{e.value}{e.suffix||''}</Typography><Typography variant="h6"sx={{mt:1}}>{e.label}</Typography></StatCard></Grid>)}</Grid></Container>}{sectionVisibility?.showAbout&&about&&<Box sx={{bgcolor:'white',py:8}}><Container maxWidth="xl"><Box textAlign="center"mb={6}><Typography variant="h3"fontWeight="bold"sx={{color:header?.primaryColor}}>{about.heading||'About'}</Typography></Box><Grid container spacing={4}><Grid item xs={12}md={6}><Typography variant="body1"paragraph>{about.description}</Typography>{about.mission&&<Box sx={{mt:3,p:3,bgcolor:'#f8f9fa',borderLeft:`4px solid ${header?.primaryColor}`}}><Typography variant="h6"fontWeight="bold">Mission</Typography><Typography variant="body2">{about.mission}</Typography></Box>}</Grid><Grid item xs={12}md={6}>{about.images?.length>0&&<Grid container spacing={2}>{about.images.slice(0,4).map((e,a)=><Grid item xs={6}key={a}><img src={getImageUrl(e)}alt="About"style={{width:'100%',height:'200px',objectFit:'cover',borderRadius:'12px'}}/></Grid>)}</Grid>}</Grid></Grid></Container></Box>}{sectionVisibility?.showPrograms&&programs?.length>0&&<Box sx={{bgcolor:'#f8f9fa',py:8}}><Container maxWidth="xl"><Box textAlign="center"mb={6}><Typography variant="h3"fontWeight="bold"sx={{color:header?.primaryColor}}>Programs</Typography></Box><Grid container spacing={4}>{programs.map((e,a)=><Grid item xs={12}sm={6}md={4}key={a}><ProgramCard><CardContent sx={{p:4}}><MenuBook sx={{fontSize:50,color:header?.primaryColor,mb:2}}/><Typography variant="h5"fontWeight="bold">{e.title}</Typography><Typography variant="body2"color="text.secondary">{e.description}</Typography>{e.ageGroup&&<Chip label={'Age: '+e.ageGroup}color="primary"sx={{mt:2}}/>}</CardContent></ProgramCard></Grid>)}</Grid></Container></Box>}{sectionVisibility?.showGallery&&gallery?.length>0&&<Box sx={{bgcolor:'white',py:8}}><Container maxWidth="xl"><Box textAlign="center"mb={6}><Typography variant="h3"fontWeight="bold"sx={{color:header?.primaryColor}}>Gallery</Typography></Box><Grid container spacing={2}>{gallery.slice(0,8).map((e,a)=><Grid item xs={12}sm={6}md={3}key={a}><Box sx={{overflow:'hidden',borderRadius:'12px',height:250,'&:hover img':{transform:'scale(1.1)'}}}><img src={getImageUrl(e.url)}alt={e.title}style={{width:'100%',height:'100%',objectFit:'cover',transition:'transform 0.3s'}}/></Box></Grid>)}</Grid></Container></Box>}{sectionVisibility?.showTestimonials&&testimonialsArray?.length>0&&<Box sx={{bgcolor:'#f8f9fa',py:8}}><Container maxWidth="xl"><Box textAlign="center"mb={6}><Typography variant="h3"fontWeight="bold"sx={{color:header?.primaryColor}}>Testimonials</Typography></Box><Grid container spacing={4}>{testimonialsArray.slice(0,3).map((e,a)=><Grid item xs={12}md={4}key={a}><Card elevation={3}sx={{p:3,height:'100%',borderTop:`4px solid ${header?.primaryColor}`}}><Box display="flex"alignItems="center"gap={2}mb={2}><Avatar sx={{width:60,height:60,bgcolor:header?.primaryColor}}>{e.parentName?.[0]}</Avatar><Box><Typography variant="subtitle1"fontWeight="bold">{e.parentName}</Typography><Typography variant="caption"color="text.secondary">Parent of {e.studentName}</Typography></Box></Box><Box mb={2}>{[...Array(5)].map((e,a)=><Star key={a}sx={{color:a<(e.rating||5)?'#FFC107':'#E0E0E0',fontSize:20}}/>)}</Box><Typography variant="body2"sx={{fontStyle:'italic'}}>"{e.comment}"</Typography></Card></Grid>)}</Grid></Container></Box>}<Box sx={{bgcolor:header?.primaryColor||'#667eea',color:'white',py:6}}><Container maxWidth="xl"><Grid container spacing={4}><Grid item xs={12}md={4}><Box display="flex"alignItems="center"gap={2}mb={2}>{header?.logo&&<Avatar src={getImageUrl(header.logo)}sx={{width:50,height:50}}/>}<Typography variant="h6"fontWeight="bold">{header?.schoolName}</Typography></Box><Typography variant="body2">{header?.tagline}</Typography></Grid><Grid item xs={12}md={4}><Typography variant="h6"fontWeight="bold"gutterBottom>Contact</Typography>{header?.contactPhone&&<Box display="flex"alignItems="center"gap={1}mb={1}><PhoneIcon fontSize="small"/><Typography variant="body2">{header.contactPhone}</Typography></Box>}{header?.contactEmail&&<Box display="flex"alignItems="center"gap={1}mb={1}><EmailIcon fontSize="small"/><Typography variant="body2">{header.contactEmail}</Typography></Box>}{header?.address&&<Box display="flex"alignItems="center"gap={1}><LocationIcon fontSize="small"/><Typography variant="body2">{header.address}</Typography></Box>}</Grid><Grid item xs={12}md={4}><Typography variant="h6"fontWeight="bold"gutterBottom>Links</Typography><Button sx={{color:'white',display:'block'}}onClick={()=>navigate('/login')}>Admin</Button><Button sx={{color:'white',display:'block'}}onClick={()=>navigate('/student-login')}>Student</Button></Grid></Grid><Box sx={{mt:4,pt:4,borderTop:'1px solid rgba(255,255,255,0.2)',textAlign:'center'}}><Typography variant="body2">Â© {new Date().getFullYear()} {header?.schoolName}</Typography></Box></Container></Box></Box>};export default PublicHomePage;
